<div class="card w-full">
  <farmbyte-tree-header title="product_tree_title" link="/inventory/products/new"/>
  <farmbyte-tree-search/>
  <p-table [resizableColumns]="true" [value]="productStore.productEntities()" styleClass="p-datatable-striped">
    <ng-template pTemplate="header">
      <tr>
        <th  pSortableColumn="reference">
          {{ 'product_tree_reference' | translate }}
          <p-sortIcon field="reference"/>
        </th>
        <th  pSortableColumn="name">
          {{ 'product_tree_name' | translate }}
          <p-sortIcon field="name"/>
        </th>
        <th  pSortableColumn="type">
          {{ 'product_tree_type' | translate }}
          <p-sortIcon field="type"/>
        </th>
        <th  pSortableColumn="categoryId">
          {{ 'product_tree_category_id' | translate }}
          <p-sortIcon field="categoryId"/>
        </th>
        <th  pSortableColumn="stockUomId">
          {{ 'product_tree_stock_uom_id' | translate }}
          <p-sortIcon field="stockUomId"/>
        </th>
        <th  pSortableColumn="purchaseUomId">
          {{ 'product_tree_purchase_uom_id' | translate }}
          <p-sortIcon field="purchaseUomId"/>
        </th>

        <th></th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-product>
      <tr>
        <td class="w-3 p-0 pl-2">{{ product?.refernce || '' }}</td>
        <td class="w-3 p-0 pl-2">{{ product.name }}</td>
        <td class="w-3 p-0 pl-2">{{ product.type | titlecase }}</td>
        <td class="w-3 p-0 pl-2">{{ productStore.findProductCategoryById(product.categoryId)()?.name }}</td>
        <td class="w-3 p-0 pl-2">{{ productStore.findUomById(product.stockUomId)()?.name || '' }}</td>
        <td class="w-3 p-0 pl-2">{{ productStore.findUomById(product.purchaseUomId)()?.name || ''}}</td>
        <td class="w-9 p-0">
          <div class="flex flex-row justify-content-end m-0 mr-2">
            <p-button
              icon="pi pi-pencil"
              [rounded]="true"
              severity="info"
              [text]="true"
              size="small"
              (onClick)="edit(product.id)"/>
            <p-button
              icon="pi pi-trash"
              severity="danger"
              [rounded]="true"
              [text]="true"
              size="small"
              (onClick)="delete(product)"/>
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>
  @if(productStore.totalElements() === 0) {
    <farmbyte-no-data-found message="product_tree_no_data_found"/>
  } @else {
    <div class="flex align-items-center justify-content-end">
      <span class="mx-1 text-color">{{'paginator_item_per_page' | translate}}: </span>
      <p-dropdown [options]="pageSizeOptions()" optionLabel="label" optionValue="value" (onChange)="onListChange($event)" [(ngModel)]="rows" (ngModelChange)="first = signal(0)" />
      <p-paginator [first]="first()" [rows]="rows()" [totalRecords]="productStore.totalElements()" (onPageChange)="onPageChange($event)" [showCurrentPageReport]="true"
                   currentPageReportTemplate="{{'paginator_page_report' | translate}}" [showPageLinks]="false" [showFirstLastIcon]="true" ></p-paginator>
    </div>
  }
</div>




